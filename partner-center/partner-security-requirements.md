---
title: Требованиях к безопасности для партнеров | Центр партнеров
ms.topic: article
ms.date: 10/11/2019
description: Сведения о требованиях к безопасности для консультантов и партнеров, участвующих в программе для поставщиков облачных решений.
author: isaiahwilliams
ms.author: iswillia
keywords: Azure Active Directory, поставщик облачных решений, программа поставщика облачных решений, CSP, поставщик панели управления, CPV, многофакторная проверка подлинности, MFA, модель безопасного приложения, безопасность
ms.localizationpriority: high
ms.openlocfilehash: b09588387d3b4f0f3f726a700245999c89755199
ms.sourcegitcommit: 9dd6f1ee0ebc132442126340c9df8cf7e3e1d3ad
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2019
ms.locfileid: "72425202"
---
# <a name="partner-security-requirements"></a>Требования к безопасности для партнеров

**Относится к**

- Всем партнерам в программе для поставщиков облачных решений:
  - прямое выставление счетов;
  - непрямой поставщик;
  - Косвенный торговый посредник
- Всем поставщикам панели управления.
- Всем консультантам.

Более высокий уровень конфиденциальности и безопасности является одним из наших главных приоритетов. Мы знаем, что лучшая защита — это предотвращение, и что мы не сильнее самого слабого звена. Именно поэтому каждый элемент в нашей экосистеме должен действовать должным образом, обеспечивая надлежащую защиту. В целях защиты партнеров и клиентов мы вводим набор обязательных требований к безопасности для консультантов, поставщиков панелей управления и партнеров, участвующих в программе поставщиков облачных решений.

## <a name="overview"></a>Обзор

Начиная с 1 августа 2019 года все партнеры обязаны применять в своем арендаторе многофакторную проверку подлинности для всех учетных записей пользователей, включая учетные записи служб. Условия, связанные с требованиями к безопасности для партнеров, добавлены в [руководство по работе с программой для поставщиков облачных решений](https://go.microsoft.com/fwlink/p/?LinkId=617100). Что касается консультантов, то для них будут действовать те же контрактные требования.

> [!NOTE]
> Мы настоятельно рекомендуем всем партнерам, осуществляющим операции через национальное облако (21Vianet, US Government и Germany), немедленно принять эти требования к безопасности. Однако эти партнеры не обязаны соответствовать требованиям к безопасности, вступившим в силу 1 августа 2019 года. Корпорация Майкрософт предоставит дополнительные сведения о применении этих требований к безопасности для национальных облаков в будущем.

Партнеры, которые не выполнят обязательные требования к безопасности, не смогут осуществлять транзакции в программе для поставщиков облачных решений или управлять клиентами, используя делегированные права администратора, после соблюдения этих требований.

## <a name="actions-that-you-need-to-take"></a>Необходимые действия

Чтобы выполнить требования к безопасности для партнеров, необходимо принудительно применять многофакторную проверку подлинности для каждой учетной записи пользователя в арендаторе партнера. Это можно сделать одним из следующих способов.

- Можно реализовать базовые политики защиты [Require MFA for admins](/azure/active-directory/conditional-access/howto-baseline-protect-administrators) (Требование MFA для администраторов) и [End user protection](/azure/active-directory/conditional-access/howto-baseline-protect-end-users) (Защита пользователей) из Azure Active Directory без дополнительных затрат.
- Можно приобрести лицензии Azure Active Directory Premium для каждой учетной записи пользователя. Дополнительные сведения см. в статье [Планирование развертывания многофакторной идентификации Azure на основе облачных служб](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-getstarted).
- Можно использовать стороннее решение, чтобы применять многофакторную проверку подлинности для каждой учетной записи пользователя в арендаторе партнера. Выбранное решение должно предоставлять ожидаемую информацию. Дополнительные сведения о том, как это обеспечить, см. в разделе [Требования к безопасности для партнеров](#how-the-requirements-will-be-enforced).

### <a name="consideration"></a>Параметр

Так как эти требования применяются ко всем учетным записям пользователей в арендаторе партнера, для обеспечения беспрепятственного развертывания необходимо учитывать несколько факторов. К ним относится идентификация учетных записей пользователей в Azure Active Directory, которые не могут выполнять многофакторную проверку подлинности, а также приложений и устройств в вашей организации, которые не поддерживают современную аутентификацию.

Перед выполнением каких-либо действий советуем определить следующее:

#### <a name="do-you-have-an-application-or-device-that-does-not-support-the-use-of-modern-authentication"></a>Есть ли у вас приложение или устройство, которое не поддерживает современную аутентификацию?

При применении многофакторной проверки подлинности устаревшие методы аутентификации на основе таких протоколов, как IMAP, POP3, SMTP и т. д., будут заблокированы, так как они не поддерживают многофакторную проверку подлинности. Чтобы устранить это ограничение, воспользуйтесь функцией, называемой [пароли приложения](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#app-passwords), чтобы проверить, можно ли еще выполнять проверку подлинности в приложении или на устройстве. Вам следует ознакомиться с советами по использованию паролей приложений, приведенных [в этом разделе](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#considerations-about-app-passwords), чтобы определить, можно ли использовать их в вашей среде.

#### <a name="do-you-have-users-using-office-365-provided-by-licenses-associated-with-your-partner-tenant"></a>Есть ли у вас пользователи Office 365 с лицензиями, связанными с вашим клиентом партнера?

Перед реализацией какого-либо решения советуем выяснить, почему пользователи применяют версию Microsoft Office в вашем арендаторе партнера. Ознакомьтесь с [инструкциями по выполнению многофакторной проверки подлинности для развертываний Office 365](https://docs.microsoft.com/office365/admin/security-and-compliance/multi-factor-authentication-plan#enable-mfa), прежде чем предпринимать какие-либо действия. Есть вероятность, что у ваших пользователей будут возникать проблемы с подключением таких приложений, как Outlook. Перед применением многофакторной проверки подлинности убедитесь, что вы используете Outlook 2013 с пакетом обновления 1 (SP1) или более поздней версии и в вашей организации включена современная аутентификация. Дополнительные сведения см. в статье [Включение современной проверки подлинности в Exchange Online](https://docs.microsoft.com/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online).

Чтобы включить современную проверку подлинности для любых устройств под управлением Windows, на которых установлен пакет Microsoft Office 2013, необходимо будет создать два раздела реестра. Дополнительные сведения см. в статье [Enable Modern Authentication for Office 2013 on Windows devices](https://docs.microsoft.com/office365/admin/security-and-compliance/enable-modern-authentication) (Включение современной проверки подлинности для Office 2013 на устройствах с Windows).

#### <a name="is-there-a-policy-preventing-any-of-your-users-from-using-their-mobile-devices-while-working"></a>Существует ли политика, запрещающая вашим пользователям использовать мобильные устройства во время работы?

Важно выявить любую корпоративную политику, запрещающую сотрудникам использовать мобильные устройства во время работы, так как она влияет на тип реализуемого решения многофакторной проверки подлинности. Существуют решения на основе [базовых политик защиты](/azure/active-directory/conditional-access/concept-baseline-protection), которые позволяют использовать только приложение Authenticator для проверки. Если в вашей организации есть политика, запрещающая использование мобильных устройств, рассмотрите один из следующих вариантов:

- Развертывание приложения, поддерживающего временные одноразовые пароли (TOTP), которое может работать в защищенной системе.
- Реализация стороннего решения, применяющего многофакторную проверку подлинности для каждой учетной записи пользователя в арендаторе партнера и обеспечивающего самый подходящий вариант проверки.
- Приобретение лицензий [Azure Active Directory Premium](https://azure.microsoft.com/pricing/details/active-directory/) для затронутых пользователей.

#### <a name="what-automation-or-integration-do-you-have-that-leverages-user-credentials-for-authentication"></a>Какая автоматизация или интеграция использует учетные данные пользователя для проверки подлинности?

Так как требование состоит в принудительном применении MFA для каждого пользователя, включая учетные записи служб, в каталоге партнера будет затронута любая автоматизация или интеграция, которая использует учетные данные пользователя для проверки подлинности. Поэтому важно определить, какие учетные записи используются в данных ситуациях. Ниже приведен список примеров приложений или служб, на которые следует обратить внимание.

- Панель управления используется для подготовки ресурсов от имени клиентов.
- Интеграция с любой платформой, которая используется для выставления счетов (так как речь идет о программе CSP) и поддержки ваших клиентов.
- Сценарии PowerShell, использующие модули Az, AzureRM, Azure AD, MS Online и т. д.

Приведенный выше список не является исчерпывающим. Поэтому важно выполнить полную оценку любого приложения или службы в вашей среде, которая использует учетные данные пользователя для проверки подлинности. Для применения обязательной многофакторной проверки подлинности следует по возможности выполнить инструкции, приведенные в статье [Enabling the Secure Application Model framework](https://docs.microsoft.com/partner-center/develop/enable-secure-app-model) (Включение платформы "Модель безопасных приложений").

## <a name="accessing-your-environment"></a>Оценка своей среды

Чтобы точно определить, кто или что выполняет аутентификацию, избегая запроса на многофакторную проверку подлинности, рекомендуем запросить журналы аудита Azure Active Directory. Это можно сделать с помощью модуля [Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview) и приведенного ниже сценария. Он создаст отчет, который предоставит сведения о выполненных за прошедший день попытках аутентификации, для которых не запрашивалась многофакторная проверка подлинности.

```powershell
Login-AzAccount
$context = Get-AzContext

function Get-SignInEvents
{
    param([string]$userId)

    $content = '{"startDateTime":"' + (Get-Date).AddDays(-1).ToUniversalTime().ToString("yyyy-MM-ddT05:00:00.000Z") + '","endDateTime":"' + (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ss.fffZ")  + '","userId":"' + $userId +'","riskState":[],"totalRisk":[],"realtimeRisk":[],"tokenIssuerType":[],"isAdfsEnabled":false}'

    $token = [Microsoft.Azure.Commands.Common.Authentication.AzureSession]::Instance.AuthenticationFactory.Authenticate($context.Account, $context.Environment, $context.Tenant.Id, $null, "Never", $null, "74658136-14ec-4630-ad9b-26e160ff0fc6")

    $headers = @{
    'Authorization' = 'Bearer ' + $token.AccessToken
    'Content-Type' = 'application/json'
        'X-Requested-With'= 'XMLHttpRequest'
        'x-ms-client-request-id'= [guid]::NewGuid()
        'x-ms-correlation-id' = [guid]::NewGuid()
    }

    Invoke-RestMethod -Body $content -Header $headers -Method POST -Uri "https://main.iam.ad.ext.azure.com/api/Reports/SignInEventsV3"
}

$report = $()

Get-AzADUser | foreach {
    $events = Get-SignInEvents $_.Id
    $report += $events.Items
}

$report | Where-Object {$_.mfaRequired -eq $false -and $_.loginSucceeded -eq $true} | Select-Object userPrincipalName, userDisplayName, createdDateTime, resourceDisplayName, loginSucceeded, failureReason, mfaRequired, mfaAuthMethod, mfaAuthDetail, mfaResult, @{Name='policies'; Expression={[string]::join(',', $($_.conditionalAccessPolicies | Select-Object displayName).displayName )}}, conditionalAccessStatus | Export-Csv report.csv
```

После запуска приведенного выше сценария сведения будут доступны в файле report.csv. Он будет содержать список попыток проверки подлинности, которые произошли за последний день, когда для пользователя не отображался запрос на выполнение MFA. Вам нужно будет просмотреть каждую запись, определив, является ли такое поведение ожидаемым, и в случае необходимости выполнить надлежащие действия.

![Отчет об оценке](images/security/assessment-report.png)

## <a name="how-the-requirements-will-be-enforced"></a>Как будут применяться требования

Требования к безопасности для партнеров будут принудительно применены платформой Azure Active Directory и Центром партнеров. Будет проверяться наличие утверждения MFA, подтверждающего, что многофакторная проверка подлинности выполнена. Если вы используете Многофакторную идентификацию Azure или базовые политики защиты, то вам не нужно предпринимать никаких дополнительных действий.

При использовании стороннего решения многофакторной проверки подлинности существует вероятность, что утверждение MFA не выдается. Если это утверждение отсутствует, Azure Active Directory не сможет определить, был ли запрос на аутентификацию выполнен с использованием многофакторной проверки подлинности. Дополнительные сведения о том, как проверить, выдает ли ваше решение ожидаемое утверждение, см. в разделе [Testing the Partner Security Requirements](https://docs.microsoft.com/powershell/partnercenter/test-partner-security-requirements) (Тестирование соответствия требованиям к безопасности для партнеров).

> [!IMPORTANT]
> Если ваше стороннее решение не выдает ожидаемое утверждение, необходимо обратиться к поставщику, разработавшему это решение, чтобы выяснить, какие действия следует предпринять.

## <a name="resources-and-support"></a>Ресурсы и поддержка

Ниже приведены ресурсы для получения поддержки и примеров кода.

- [Partner Center Security Guidance Group](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) (Консультативная группа по обеспечению безопасности в Центре партнеров). Это онлайн-сообщество, где вы можете узнать о предстоящих событиях и задать любые вопросы, которые могут у вас возникнуть.
- [Partner Center .NET Samples](https://github.com/microsoft/partner-center-dotnet-samples) (Центр партнеров: примеры для .NET). Этот репозиторий GitHub содержит примеры, разработанные с использованием .NET, которые демонстрируют способ реализации платформы модели безопасных приложений.
- [Partner Center Java Samples](https://github.com/microsoft/partner-center-java-samples) (Центр партнеров: примеры для Java). Этот репозиторий GitHub содержит примеры, разработанные с использованием Java, которые демонстрируют способ реализации платформы модели безопасных приложений.
- [Multi-Factor Authentication](https://docs.microsoft.com/powershell/partnercenter/multi-factor-auth) (Многофакторная проверка подлинности). Эта статья содержит подробные сведения о реализации платформы "Модель безопасных приложений" с помощью PowerShell.
